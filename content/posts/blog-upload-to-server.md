---
title: å‰å°è‡ªåŠ¨è¿ç»´å°æŠ€å·§ğŸ™ƒ
date: 2022-03-28 18:12:41
categories: 
	- è¿ç»´
tags: 
	- è¿ç»´ 
    - ç¼–ç¨‹å·¥å…·
---



## ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·éƒ¨ç½²å‰å°æ–‡ä»¶

> ä½ åœ¨ä¸ºæ¯æ¬¡æ‹–æ‹‰æ–‡ä»¶è¿›å…¥æœåŠ¡å™¨è€Œçƒ¦æ¼å—ï¼Ÿä½ è¿˜åœ¨ä½¿ç”¨æ‰‹åŠ¨è¾“å…¥å‘½ä»¤è¡Œçš„æ–¹å¼æ¥ä¸Šçº¿é¡¹ç›®å—ï¼Ÿ
>
> é†’é†’ï¼Œç°åœ¨å·²ç»æ˜¯è‡ªåŠ¨åŒ–çš„æ—¶ä»£äº†ï¼Œå¤šçœ‹çœ‹å¤–è¾¹çš„ä¸–ç•Œå§ï¼ˆç¬”è€…ä¹Ÿæ˜¯è‹¦è¿ç»´ä¹…çŸ£ï¼Œç›´åˆ°å‘ç°äº†è‡ªåŠ¨éƒ¨ç½²çš„æ–°å¤©åœ°ï¼‰

### ä¸€ã€è½¬æˆ˜Nuxt

ç¬”è€…çš„åšå®¢å¹³å°åˆšåˆšå®Œæˆä» hexo åˆ° nuxt.js è‡ªå®šä¹‰è½¬å‹ï¼Œæ¯•ç«Ÿæ›¾ç»æ¥æ‰‹è¿‡ Vue é¡¹ç›®ã€‚

ä¸ºä½•æŠ›å¼ƒè¯¸å¦‚ hexo å’Œ hugo è¿™æ ·çš„è‡ªåŠ¨åŒ–åšå®¢å¹³å°å‘¢ï¼Ÿ

ä¸»è¦çš„æ˜¯æœ‰ä¸¤ä¸ªåŸå› ï¼š

- hexo åœ¨å¯¹åšå®¢CSSä»£ç çš„ç¼–å†™ä¸åƒ nuxt ä¸­é‚£æ ·æ–¹ä¾¿
- è‡ªå·±å¼€å‘çš„é¡µé¢å¯é€‰æ‹©çš„æ–¹å‘ä¼šæ›´å¤šä¸€äº›ï¼ŒåŒæ—¶å¯ä»¥å·©å›ºä¸€ä¸‹å‰ç«¯çš„åŸºç¡€

### äºŒã€è‡ªåŠ¨åŒ–éƒ¨ç½²

æƒ³èµ·æ¥ä¹‹å‰è‡ªå·±æ—¢æ‰¿æ‹…å‰åç«¯å¼€å‘çš„å·¥ä½œï¼ŒåŒæ—¶ä¹Ÿæ‰¿æ‹…éƒ¨ç½²è¿ç»´çš„å·¥ä½œï¼Œæ€»æ˜¯ä¼šæµªè´¹ä¸€å¤§å †çš„æ—¶é—´æ¥å®‰è£…å„ç§éƒ¨ç½²åº”ç”¨ã€‚æœ€å¼€å§‹åŸºæœ¬æ˜¯all in docker ï¼Œä½†æ˜¯ç”¨ç€dockerçš„æ—¶å€™å‘ç°ï¼Œdocker ä¸­å®‰è£…æ•°æ®åº“ä¼šä½¿å¾—æ•°æ®åº“çš„æ€§èƒ½å¤§æ‰“æŠ˜æ‰£ï¼Œéƒ¨ç½²å‰å°é¡¹ç›®ä¹Ÿä¼šåŠ è½½çš„å¼‚å¸¸ç¼“æ…¢ï¼Œæ‰€ä»¥åˆ°æœ€ååŸºæœ¬æ˜¯å¾’æ‰‹å®‰è£…æ•°æ®åº“å’Œé™æ€æ–‡ä»¶æœåŠ¡ã€‚æ¯”å¦‚å¯¹nginxçš„å„ç§é…ç½®ï¼Œè¿˜æœ‰æ·»åŠ httpsçš„è¯ä¹¦ï¼Œåœ¨æ¯æ¬¡é¡¹ç›®è¿­ä»£çš„æ—¶å€™éƒ½éœ€è¦æ‰‹åŠ¨å°†ç¼–è¯‘åçš„æ–‡ä»¶æ‹‰åˆ°æœåŠ¡å™¨ä¸Šï¼Œç„¶åå†é‡å¯åº”ç”¨ï¼ˆä¸å¾—ä¸ä½©æœæˆ‘æ˜¯å¦‚ä½•åšæŒä¸‹å»çš„ï¼‰

ä½œä¸ºä¸ªäººå¼€å‘è€…ï¼Œæ‰‹å¤´ä¸Šæœ‰æ²¡æœ‰è‡ªåŠ¨åŒ–éƒ¨ç½²çš„å¹³å°å¯ä»¥ä½¿ç”¨ï¼ˆå…¶å®æ˜¯ä¸èˆå¾—èŠ±é’±ï¼‰ï¼Œä¸è¿‡åœ¨è¿™æ¬¡éƒ¨ç½²åšå®¢çš„æ—¶å€™ï¼Œæˆ‘å†ä¹Ÿå¿å—ä¸äº†æ‰‹åŠ¨å†™shellçš„ç—›äº†ğŸ˜£ï¼Œæ‰€ä»¥ç—›å®šæ€ç—›å¼€å§‹æŸ¥æ‰¾è‡ªåŠ¨åŒ–éƒ¨ç½²çš„æ–¹æ¡ˆï¼Œæˆ‘å¼€å§‹äº†æ¼«é•¿çš„è‡ªåŠ¨åŒ–çš„å®è·µè¿‡ç¨‹ã€‚

**æ–¹æ¡ˆ**ï¼šWebHook + Caddy

å…¶å®åƒ Github è¿™ç§ä»£ç éƒ¨ç½²å¹³å°éƒ½ä¼šæä¾›ä¸€äº›å·¥å…·æ¥å¯¹ä»“åº“è¿›è¡Œç»´æŠ¤ï¼Œæ¯”å¦‚åœ¨ Go çš„ç¤¾åŒºä¸­å¯ä»¥é€šè¿‡ workflow æä¾›ä¸€äº› issue çš„æ¨¡æ¿ï¼ŒåŒæ—¶ä½ åœ¨ Github ä¸­æäº¤çš„ issue ä¹Ÿä¼šåŒæ­¥åˆ° Go çš„å®˜æ–¹ç¤¾åŒºå¹³å°ï¼Œè¿™äº›éƒ½æ˜¯å¯ä»¥é¢„è§çš„ä¾¿åˆ©ã€‚

![image-20220328195315561](https://yili979.oss-cn-beijing.aliyuncs.com/img/202203281953131.png)

å½“ç„¶ ä»£ç å¹³å° æ‰€èƒ½åšåˆ°çš„äº‹æƒ…è¿œè¿œä¸æ­¢äºæ­¤ï¼Œæ¯”å¦‚ä½ è¿˜å¯ä»¥åˆ©ç”¨å®ƒæ¥è‡ªåŠ¨æ›´æ–°æœ¬åœ°ä»“åº“ï¼Œä½¿ç”¨ WebhooksåŠŸèƒ½ï¼Œåœ¨æ¯æ¬¡é¡¹ç›®ä»£ç å¾—åˆ°æ›´æ–°çš„æ—¶å€™ä¼šå‘ä½ æŒ‡å®šçš„ç½‘ç«™å’Œæ¥å£å‘é€è°ƒç”¨é€šçŸ¥ä½ çš„åº”ç”¨åº”è¯¥æ‹‰å–é¡¹ç›®æ–‡ä»¶å•¦ï¼å½“ç„¶è¿™ç§åŠŸèƒ½å¯ä»¥ä¸ä½¿ç”¨ Github æ‰€æä¾›çš„æ–¹å¼æ¥è¿›è¡Œæ“ä½œï¼Œä¹Ÿå¯ä»¥è‡ªå»ºä¸€ä¸ªç›‘å¬å™¨æ¥ç›‘å¬é¡¹ç›®æ˜¯å¦å¾—åˆ°æ›´æ–°ï¼Œå¦‚æœæ›´æ–°åˆ™ç«‹å³å¯¹ä»£ç è¿›è¡Œpullï¼Œæ¯”å¦‚ä¸‹é¢ä¾¿æ˜¯è®¾ç½®çš„ Webhooks ã€‚

![image-20220328205238551](https://yili979.oss-cn-beijing.aliyuncs.com/img/202203282052914.png)

å½“ç„¶ä»…ä»…ä½¿ç”¨Webhooks æ˜¯ä¸å¤Ÿçš„ï¼Œéƒ¨ç½²å‰ç«¯é¡¹ç›®æ–‡ä»¶è¿˜éœ€è¦ä¸€ä¸ªæ–‡ä»¶æœåŠ¡å™¨ï¼Œæœ€å¸¸ç”¨çš„è«å±Nginxäº†ï¼Œä¸è¿‡åœ¨è¿™æ¬¡éƒ¨ç½²ä¸­æˆ‘å‘ç°äº†ä¸€ä¸ªå®è—é¡¹ç›®ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªä»¤æˆ‘çœ¼å‰ä¸€äº®çš„é¡¹ç›®â€”â€” Caddy ã€‚

Caddy æ˜¯ä¸€æ¬¾ä½¿ç”¨ Go è¯­è¨€æ¥æ„å»ºçš„å¯æ‹“å±•æ€§çš„æœåŠ¡å™¨å¹³å°ï¼Œå…¶ä¸­æœ€ä½¿ç”¨çš„åŠŸèƒ½ä¾¿æ˜¯ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª ssl è¯ä¹¦ï¼Œä¹Ÿå°±æ˜¯è¯´å†ä¹Ÿä¸ç”¨ç»å†ç¹ççš„æ­¥éª¤å»ç”³è¯·ä¸€ä¸ªè¯ä¹¦äº†ï¼Œé€šè¿‡ä½¿ç”¨ Caddy ï¼Œå®ƒä¼šè‡ªåŠ¨çš„å¸®ä½ ç”³è¯·ä¸€ä¸ªè¯ä¹¦ï¼ŒåŒæ—¶å…¶é…ç½®æ–¹å¼ä¹Ÿååˆ†ç®€ç•¥ï¼Œå¯ä»¥ä½¿ç”¨è°ƒç”¨ç½‘ç»œ API çš„æ–¹å¼æ¥å¯¹æœåŠ¡å™¨è¿›è¡Œé…ç½®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Caddyfile çš„å½¢å¼æ¥å¯¹æœåŠ¡å™¨è¿›è¡Œé…ç½®ï¼ŒåŒæ—¶Caddy ä¹Ÿæ˜¯æ”¯æŒåå‘ä»£ç†çš„ï¼Œä½¿ç”¨è¯¸å¦‚ä¸€äº›å•é¡µåº”ç”¨ä¹Ÿå¯ä»¥ä½¿ç”¨ Caddy æ¥è¿›è¡Œéƒ¨ç½²ã€‚

### ä¸‰ã€éƒ¨ç½²

é¦–å…ˆéœ€è¦åœ¨æœ¬åœ°å»ºç«‹ä¸€ä¸ªä»“åº“ï¼Œç„¶åå°†ç¼–è¯‘å¥½çš„å‰å°æ–‡ä»¶æ”¾ç½®åˆ°è¿œç¨‹çš„ä»“åº“ä¸­ï¼š

```shell
cd public
git init
git add .
git commit -m "feat: first commit"
git branch -M master
git remote add origin https:// ....
git push -u origin master
```

åœ¨æ­¤æ¬¡éƒ¨ç½²ä¸­ï¼Œç”±äºéœ€è¦ä½¿ç”¨åˆ° Caddy çš„æ’ä»¶åŠŸèƒ½ï¼Œæ‰€ä»¥éœ€è¦å®‰è£… Go ç¯å¢ƒæ¥å¯¹Caddy è¿›è¡Œé‡æ–°ç¼–è¯‘ï¼Œå¾—åˆ°ä¸€ä¸ªæ”¯æŒè¿œç¨‹ä»£ç åŒæ­¥æ›´æ–°çš„åº”ç”¨ã€‚

Linux ä¸­å®‰è£… Go

```shell
rm -rf /usr/local/go && tar -C /usr/local -xzf go1.~.~.linux-amd64.tar.gz
echo "export PATH=$PATH:/usr/local/go/bin" >> ~/.bashrc
source .bashrc
```

é‡æ–°ç¼–è¯‘ Caddy 

```shell
go install github.com/caddyserver/xcaddy/cmd/xcaddy@latest
mkdir caddy
cd caddy
xcaddy build --with github.com/WingLim/caddy-webhook
```

æ¥ä¸‹æ¥æ˜¯åˆ›å»ºä¸€ä¸ª Caddyfile é…ç½®æ–‡ä»¶ï¼Œåœ¨ç¼–è¯‘å Caddy çš„åŒçº§ç›®å½•ä¸­ã€‚

```apl
example.com {
    tls yourmail@example.com
    encode zstd gzip
    root blog
    file_server

    handle_errors {
        @404 {
            expression {http.error.status_code} == 404
        }
        handle @404 {
            rewrite * /404.html
            file_server
        }
    }

    route /webhook {
        webhook {
            repo https://gitee.com/user/repo.git
            branch master
            path blog
            secret yoursecret
            submodule
            type gitee
        }
    }
}
```

ç„¶åè¿è¡Œ caddy start ä¾¿å‘ç°åœ¨æŒ‡å®šçš„åŸŸåä¸‹å¯ä»¥è®¿é—®åˆ°æˆ‘ä»¬æ‰€éƒ¨ç½²çš„å‰å°é¡¹ç›®äº†ã€‚

å¦‚æœä½ ç›¸å¯¹ Caddy è¿›è¡Œä¸€äº›å®šåˆ¶åŒ–æ“ä½œï¼Œå»ºè®®å‚è€ƒ Caddy æ‰€åœ¨çš„å®˜æ–¹æ–‡æ¡£ [https://caddyserver.com/docs/](https://caddyserver.com/docs/)

### æœ«ã€åè®°

å½“æˆ‘ä»¬å»å®Œæˆä¸€ä»¶äº‹æƒ…çš„æ—¶å€™æ€»æ˜¯éœ€è¦æ¶ˆè€—å¤§é‡çš„æ—¶é—´æ—¶ï¼Œå°±éœ€è¦æ€è€ƒæ€æ ·å°†äº‹æƒ…æ›´åŠ æ–¹ä¾¿çš„è¿›è¡Œè§£å†³ï¼Œè€Œä¸æ˜¯ç»§ç»­æ— æ„ä¹‰çš„ä½“åŠ›åŠ³åŠ¨ã€‚

æ¯”å¦‚æˆ‘æœ€è¿‘å°±åˆåœ¨å¤´ç–¼å¤šè®¾å¤‡ä¹‹é—´æ–‡ä»¶ä¼ é€’çš„é—®é¢˜ï¼Œæ‰€ä»¥å¯ä»¥é‡è§çš„å‡ å‘¨å†…ï¼Œæˆ‘ä¼šæ­å»ºèµ·ä¸€ä¸ª è‡ªå·±éƒ¨ç½²çš„ **ç½‘ç›˜é¡¹ç›®**ï¼Œæ•¬è¯·æœŸå¾…ï¼

å¾…ç»­
